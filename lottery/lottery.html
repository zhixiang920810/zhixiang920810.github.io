<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>lottery</title>
    <link href="layuiadmin/layui/css/layui.css" media="all" rel="stylesheet">
    <script src="layuiadmin/layui/layui.js"></script>
</head>

<body>
    <!-- 1.随机生成号码  -- ok
         2.排除哪些号码再随机：机选两注，把这里号码都排除掉再随机  -- ok
         3. 生成号码放入表格：删除、编辑 导出来  -- ok
         4.随机指定范围数字，可随机几个  -- 给一个输入框或是范围轴   初始化的数组就取这个范围
         5.胆拖  ？
         6.试试：找几个规律，用历史数据跑下看有多少符合的；找几个结构差不多的情况，然后找历史记录；？


         用随机数字中出号码：去除随机号码 再随机一次的号码  ： 结合起来中间码概率比较高
         
         号码的常规套路：
         1.
    -->
    <div class="layui-container1">
        <form class="layui-form">
            <div class="layui-collapse" lay-filter="form_zd">
                <div class="layui-colla-item">
                    <h2 class="layui-colla-title">随机表单数据</h2>
                    <div class="layui-colla-content layui-show">
                        <div class="layui-row mar-20">
                            <div class="layui-col-md12 search1">
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">类型</label>
                                        <div class="layui-inline">
                                            <select name="lx" id="lx">
                                                <option value=""></option>
                                                <option value="1">排除号码随机</option>
                                                <option value="2">全局随机</option>
                                                <option value="3">机选+排除号码自选中间码</option>
                                                <option value="4">选上期3个号码推演（套路一）</option>
                                                <option value="5">和值推演（套路二）</option>
                                                <option value="6">篮球杀号</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">事件标题</label>
                                        <div class="layui-inline layui-form">
                                            <input name="number1" id="number1" class="layui-input" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">事件内容</label>
                                        <div class="layui-inline layui-form">
                                            <input name="number2" id="number2" class="layui-input" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">风险层级</label>
                                        <div class="layui-inline layui-form">
                                            <input name="number3" id="number3" class="layui-input" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">风险等级</label>
                                        <div class="layui-inline layui-form">
                                            <input name="number4" id="number4" class="layui-input" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">开始时间</label>
                                        <div class="layui-inline">
                                            <div class="layui-card layui-form">
                                                <input name="number5" id="number5" class="layui-input"
                                                    autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">结束时间</label>
                                        <div class="layui-inline">
                                            <div class="layui-card layui-form">
                                                <input name="number6" id="number6" class="layui-input"
                                                    autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">蓝</label>
                                        <div class="layui-inline">
                                            <div class="layui-card layui-form">
                                                <input name="lan_number" id="lan_number" class="layui-input"
                                                    autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">排除1</label>
                                        <div class="layui-inline">
                                            <div class="layui-card layui-form">
                                                <input name="red_pc_number" id="red_pc_number" class="layui-input"
                                                    placeholder="1,2" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">排除2</label>
                                        <div class="layui-inline">
                                            <div class="layui-card layui-form">
                                                <input name="lan_pc_number" id="lan_pc_number" class="layui-input"
                                                    placeholder="1,2" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- <div class="layui-col-md1">
                                <div class="zksj">
                                    展开 <img src="../zdry/img/jiantou3.png">
                                </div>
                                <div class="sqsj">
                                    收起 <img src="../zdry/img/jiantou4.png">
                                </div>
                            </div> -->
                            <div class="layui-col-md3">
                                <button type="button" lay-submit lay-filter="formData"
                                    class="layui-btn layui-btn-normal">
                                    <i class="layui-icon layui-icon-addition"></i>
                                    随机
                                </button>
                                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                                <button type="button" lay-submit lay-filter="formData1"
                                    class="layui-btn layui-btn-normal">
                                    <i class="layui-icon layui-icon-addition"></i>
                                    提交
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 选择上期三个开奖号码为重叠码来推演 -->
                <div class="layui-colla-item">
                    <h2 class="layui-colla-title">选上期3个号码推演（套路一）</h2>
                    <div class="layui-colla-content layui-show">
                        <div class="layui-row">
                            <div class="layui-col-md3">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">上期号码：</label>
                                    <div class="layui-inline layui-form">
                                        <input name="kjhm" id="kjhm" class="layui-input" autocomplete="off"
                                            placeholder="2,5,16,17,18,25+6">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-row mar-20">
                            <div class="layui-col-md12 search1">
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">重叠01</label>
                                        <div class="layui-inline layui-form">
                                            <input name="cd_number1" id="cd_number1" class="layui-input"
                                                autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">重叠02</label>
                                        <div class="layui-inline layui-form">
                                            <input name="cd_number2" id="cd_number2" class="layui-input"
                                                autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">重叠03</label>
                                        <div class="layui-inline layui-form">
                                            <input name="cd_number3" id="cd_number3" class="layui-input"
                                                autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="layui-col-md3">
                                <button type="button" lay-submit lay-filter="formData2"
                                    class="layui-btn layui-btn-normal">
                                    <i class="layui-icon layui-icon-addition"></i>
                                    重叠码推演
                                </button>
                                <button type="button" lay-submit lay-filter="formData3"
                                    class="layui-btn layui-btn-normal">
                                    <i class="layui-icon layui-icon-addition"></i>
                                    和值推演
                                </button>

                            </div>
                        </div>
                    </div>
                </div>
                <!-- 选择上期三个开奖号码为重叠码来推演 -->
                <div class="layui-colla-item">
                    <h2 class="layui-colla-title">蓝球杀号</h2>
                    <div class="layui-colla-content layui-show">

                        <div class="layui-row mar-20">
                            <div class="layui-col-md12 search1">
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">上一期蓝：</label>
                                        <div class="layui-inline layui-form">
                                            <input name="sq_number" id="sq_number" class="layui-input"
                                                autocomplete="off" value="14">
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">上两期蓝：</label>
                                        <div class="layui-inline layui-form">
                                            <input name="sq_number1" id="sq_number1" class="layui-input"
                                                autocomplete="off" value="6">
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">上三期蓝：</label>
                                        <div class="layui-inline layui-form">
                                            <input name="sq_number2" id="sq_number2" class="layui-input"
                                                autocomplete="off" value="8">
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">上四期蓝：</label>
                                        <div class="layui-inline layui-form">
                                            <input name="sq_number3" id="sq_number3" class="layui-input"
                                                autocomplete="off" value="3">
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div class="layui-col-md3">
                                <button type="button" lay-submit lay-filter="formData4"
                                    class="layui-btn layui-btn-normal">
                                    <i class="layui-icon layui-icon-addition"></i>
                                    杀号计算
                                </button>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-colla-item">
                    <h2 class="layui-colla-title">数据展示</h2>
                    <div class="layui-colla-content layui-show">
                        <div class="layui-row mar-20">
                            <div class="layui-col-md9 search1">
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">事件标题</label>
                                        <div class="layui-inline layui-form">
                                            <input name="sjbt" class="layui-input" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">事件内容</label>
                                        <div class="layui-inline layui-form">
                                            <input name="sjnr" class="layui-input" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">风险层级</label>
                                        <div class="layui-inline layui-form">
                                            <select name="fxcj" id="fxcj">
                                                <option value=""></option>
                                                <option value="1">县域</option>
                                                <option value="2">市域</option>
                                                <option value="3">省域</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">风险等级</label>
                                        <div class="layui-inline layui-form">
                                            <select name="fxdj" id="fxdj">
                                                <option value=""></option>
                                                <option value="1">高</option>
                                                <option value="2">中</option>
                                                <option value="3">低</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">开始时间</label>
                                        <div class="layui-inline">
                                            <div class="layui-card layui-form">
                                                <input type="text" name="kssj" id="kssj" placeholder="请选择开始时间"
                                                    autocomplete="off" class="layui-input" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">结束时间</label>
                                        <div class="layui-inline">
                                            <div class="layui-card layui-form">
                                                <input type="text" name="jssj" id="jssj" placeholder="请选择结束时间"
                                                    autocomplete="off" class="layui-input" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- <div class="layui-col-md1">
                                <div class="zksj">
                                    展开 <img src="../zdry/img/jiantou3.png">
                                </div>
                                <div class="sqsj">
                                    收起 <img src="../zdry/img/jiantou4.png">
                                </div>
                            </div> -->
                            <div class="layui-col-md3">
                                <button type="button" lay-submit lay-filter="formData_cx"
                                    class="layui-btn layui-btn-normal">
                                    <i class="layui-icon layui-icon-search"></i>
                                    查询
                                </button>
                                <button type="button" lay-submit lay-filter="formData_xz"
                                    class="layui-btn layui-btn-normal">
                                    <i class="layui-icon layui-icon-addition"></i>
                                    新增
                                </button>

                            </div>
                        </div>
                        <div class="tabel_data">
                            <table id="tableDate" lay-filter="tableDate"></table>
                        </div>
                        <script type="text/html" id="barDemo">

                             <a class="layui-btn  layui-btn-xs" lay-event="delete" >删除</a>
						
                        </script>
                        <script type="text/html" id="toolbarDemo">
                            <div class="layui-btn-container">
                                <a class="layui-btn layui-btn-sm" lay-event="checkStatus">
                                    导出
                                </a>
                            </div>   
                        </script>
                    </div>
                </div>
            </div>


        </form>
    </div>
</body>
<script>
    layui.config({
        base: 'layuiadmin/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index', 'console']);

    layui.use(['jquery', 'table', 'form', 'element', 'excel'], function () {
        var $ = layui.jquery;
        var excel = layui.excel;
        console.log($('#test').html());
        var table = layui.table;
        var element = layui.element;
        var form = layui.form;
        console.log(table);
        element.on('collapse(form_zd)', function (data) {
            console.log(data);

            console.log(data.show);

        })
        //随机数字 （可排除部分数字）
        form.on('submit(formData)', function (res) {
            console.log(res);
            var field = res.field;
            var red_pc_number = $('#red_pc_number').val().replace(/，/g, ',').split(',')[0] == '' ? '' : $('#red_pc_number').val().replace(/，/g, ',').split(',');
            var lan_pc_number = $('#lan_pc_number').val().replace(/，/g, ',').split(',')[0] == '' ? '' : $('#lan_pc_number').val().replace(/，/g, ',').split(',');
            console.log(red_pc_number);
            console.log(lan_pc_number);
            var red_number = [];
            var blue_number = [];
            //生成数字范围
            for (var index = 0; index < 33; index++) {
                var flag = true;
                if (red_pc_number.length != 0) {
                    for (var j = 0; j < red_pc_number.length; j++) {//去掉不想要的数字
                        // console.log(parseInt(red_pc_number[j]));
                        // console.log(index+1);
                        // console.log(parseInt(red_pc_number[j]) != index+1);
                        if (parseInt(red_pc_number[j]) == index + 1) {
                            flag = false;
                            break;
                        }
                    }
                }
                if (flag) {
                    red_number.push(index + 1)
                }
            }
            for (var index = 0; index < 16; index++) {
                var flag = true;
                if (lan_pc_number.length != 0) {
                    for (var j = 0; j < lan_pc_number.length; j++) {
                        // console.log(parseInt(red_pc_number[j]));
                        // console.log(index+1);
                        // console.log(parseInt(red_pc_number[j]) != index+1);
                        if (parseInt(lan_pc_number[j]) == index + 1) {
                            flag = false;
                            break;
                        }
                    }
                }
                if (flag) {
                    blue_number.push(index + 1)
                }
            }
            // console.log(blue_number);
            var ran = parseInt(Math.random() * red_number.length);//随机数组的下标  （下标范围就是数组的长度）
            $('#number1').val(red_number[ran]);
            red_number.splice(ran, 1);
            ran = parseInt(Math.random() * red_number.length);
            $('#number2').val(red_number[ran]);
            red_number.splice(ran, 1);
            ran = parseInt(Math.random() * red_number.length);
            $('#number3').val(red_number[ran]);
            red_number.splice(ran, 1);
            ran = parseInt(Math.random() * red_number.length);
            $('#number4').val(red_number[ran]);
            red_number.splice(ran, 1);
            ran = parseInt(Math.random() * red_number.length);
            $('#number5').val(red_number[ran]);
            red_number.splice(ran, 1);
            ran = parseInt(Math.random() * red_number.length);
            $('#number6').val(red_number[ran]);
            red_number.splice(ran, 1);


            var blue_ran = parseInt(Math.random() * blue_number.length);
            $('#lan_number').val(blue_number[blue_ran]);
        })


        var col_column = [];
        col_column.unshift({ type: 'checkbox', width: '5%' })//插入
        col_column.push({ field: 'red', title: 'red', align: 'center', width: '50%', edit: 'text' })//插入   
        col_column.push({ field: 'blue', title: 'blue', align: 'center', width: '10%', edit: 'text' })//插入
        col_column.push({ field: 'lx', title: 'lx', align: 'center', width: '15%', edit: 'text' })//插入
        col_column.push({ field: 'title', title: '操作', toolbar: '#barDemo', align: 'center', width: '20%' })

        // col_column.
        var table_data = table.render({
            elem: '#tableDate',
            id: 'tableDate',
            method: 'get',
            toolbar: '#toolbarDemo',
            url: 'layuiadmin/json/console/top-card.js',
            // url:'',
            // page: true,
            // even: even,
            limit: 1000,
            cols: [
                col_column

            ],
            // done: function (res, curr, count) {
            //     console.log(res);
            //     var arr = res.data;
            //     for (var index = 0; index < arr.length; index++) {
            //         var element = arr[index];
            //         console.log(element.SJCOUNT);
            //         console.log(element.SJCOUNT != '0');
            //         if (element.SJCOUNT != '0') {
            //             if (sjxx_map.has(element.QBZTNRBH)) {
            //                 if (sjxx_map.get(element.QBZTNRBH) == 1) {
            //                     sjxx_map.set(element.QBZTNRBH, 0);
            //                     $('#' + element.QBZTNRBH).attr("class", "button3  layui-btn-xs");
            //                     $('#' + element.QBZTNRBH).attr("lay-event", "delete");
            //                     $('#' + element.QBZTNRBH).text("取消物建");
            //                 }
            //             } else {
            //                 sjxx_map.set(element.QBZTNRBH, 0);
            //                 $('#' + element.QBZTNRBH).attr("class", "button3  layui-btn-xs");
            //                 $('#' + element.QBZTNRBH).attr("lay-event", "delete");
            //                 $('#' + element.QBZTNRBH).text("取消物建");
            //             }
            //         }
            //     }
            // }
        });
        table.on('tool(tableDate)', function (obj) {
            var data = obj.data;
            console.log(obj);
            if (obj.event == 'del') {

            } else if (obj.event == 'delete') {
                obj.del();
                var list = table.cache['tableDate'];//从缓存中拿数据
                //去除空数组
                for (var index = 0; index < list.length; index++) {
                    var element = list[index];
                    if (element.length == 0) {
                        list.remove_arr(element)
                    }
                }
                console.log(list);
                //重新渲染列表信息
                table_data.reload({
                    // page:{curr:1},
                    url: '',
                    data: list
                })
            }

        });
        table.on('toolbar(tableDate)', function (obj) {
            console.log(obj);
            var checkStatus = table.checkStatus(obj.config.id);
            console.log(checkStatus);
            if (obj.event == 'checkStatus') {
                var list = [];//先定义一个空数组，每次导出都会清空  -- 防止了第二次导出会出现多次列名
                console.log(obj.config.data);
                list.push(...obj.config.data);
                list.unshift({ red: '红', blue: '蓝', lx: '类型' });
                console.log(list);
                var data = excel.filterExportData(list, [//列头顺序可以重新排列的函数
                    'red',
                    'blue',
                    'lx',
                ]);
                excel.setExportCellStyle(data, 'A1:D1', {
                    s: {
                        // fill:{},
                        alignment: {
                            horizontal: 'center',
                            vertical: 'center',
                            wrapText: true,
                        }

                    }
                })
                // layer.close(index);
                excel.exportExcel({
                    sheet1: data
                }, '随机号码.xlsx');
            }

        })

        //新增一行
        form.on('submit(formData1)', function (res) {
            var field = res.field;
            //排序
            var cl_data = [field.number1, field.number2, field.number3, field.number4, field.number5, field.number6]
            for (var i = 0; i < cl_data.length - 1; i++) {
                for (var j = 0; j < cl_data.length - i - 1; j++) {
                    if (parseInt(cl_data[j]) > parseInt(cl_data[j + 1])) {
                        var temp = cl_data[j];
                        cl_data[j] = cl_data[j + 1]
                        cl_data[j + 1] = temp;
                    }

                }
            }
            var red_number = '';
            for (var i = 0; i < cl_data.length; i++) {
                red_number += cl_data[i] + " "
            }
            var newData = { red: red_number, blue: field.lan_number, lx: $('#lx option:selected').text() }
            var oldData = table.cache['tableDate'];//从缓存中拿数据
            console.log(oldData);
            oldData.unshift(newData)
            table_data.reload({
                // page:{curr:1},
                url: '',
                data: oldData
            })
        })
        //新增一行 套路一 : 重叠码推演
        form.on('submit(formData2)', function (res) {
            console.log(res);
            var field = res.field;
            //重叠码
            var cd_number1 = parseInt(field.cd_number1);
            var cd_number2 = parseInt(field.cd_number2);
            var cd_number3 = parseInt(field.cd_number3);
            var cd_numbers = [parseInt(field.cd_number1), parseInt(field.cd_number2), parseInt(field.cd_number3)]
            var selected_number = [];
            var all_result_fx = [];
            //叠连码  选1个：人工看自己看图    我这边是随机
            selected_number.push(dlm(cd_number1, cd_number2, cd_number3, all_result_fx));
            //同位码  一般是间隔0,1,2,3步 如果重叠码为33 最好间隔1步  则为31  这时候同位码为01,11或21 选两个
            twm_way(cd_numbers, selected_number, all_result_fx);
            //叠码选择
            dm_xz(selected_number, all_result_fx);
            //筋斗码 : 12-21  13-31等
            jdm_xz(selected_number, all_result_fx)
            //倍数码：7.12.32   7+12=19 32/8=4  4和19可选  太多了，不好计算 ？？？  
            // var bs_get = [];
            // for (var index = 0; index < selected_number.length; index++) {
            //     var element = selected_number[index];
            //     if(element <= 17){
            //         bs_get.push(element);
            //     }
            // }
            // bs_xz(selected_number);
            //常用组合号码 http://www.360doc.com/content/18/1218/21/6610157_802737278.shtml
            zh_xz(selected_number, all_result_fx);

            selected_number = unique(selected_number)//去重
            mp(selected_number)//排序
            console.log(selected_number);
            var newData = { red: selected_number + all_result_fx, blue: field.lan_number, lx: $('#lx option:selected').text() }
            var oldData = table.cache['tableDate'];//从缓存中拿数据
            // console.log(oldData);
            oldData.unshift(newData)
            table_data.reload({
                // page:{curr:1},
                url: '',
                data: oldData
            })

        })
        //新增一行 套路二  和值推演
        form.on('submit(formData3)', function (res) {
            console.log(res);
            var field = res.field;
            //计算和值
            var kjhm = field.kjhm.replace(/，/g, ',').substring(0, field.kjhm.lastIndexOf("+"));
            var kjhms = kjhm.split(",");
            var hz = 0;
            for (var index = 0; index < kjhms.length; index++) {
                var element = kjhms[index];
                hz += parseInt(element)
            }
            var yz = []; //计算商，小数点后面不要
            for (var index = 0; index < kjhms.length; index++) {
                var element = kjhms[index];
                var sz = Math.floor((hz - element) / element);//取商值，小数点后面不要
                var weihao = sz >= 10 ? sz % 10 : sz;//取尾号
                yz.push(weihao);
            }
            yz = unique(yz)//去重
            mp(yz)//排序
            var selected_number = []; //关于计算后的尾号所有的号码陈列
            for (var index = 0; index < yz.length; index++) {
                var element = yz[index];
                if (element > 3) {
                    for (var j = 0; j < 3; j++) {
                        selected_number.push(j + "" + element);
                    }
                } else {
                    for (var j = 0; j < 4; j++) {
                        selected_number.push(j + "" + element);
                    }
                }
            }
            //如果上期没有遗传号（本期就找和上期重叠的号码），本期很可能出现反之 ？？ 标记一下


            selected_number = unique(selected_number)//去重
            mp(selected_number)//排序
            console.log(selected_number + "");
            var newData = { red: selected_number + "", blue: field.lan_number, lx: $('#lx option:selected').text() }
            var oldData = table.cache['tableDate'];//从缓存中拿数据
            // console.log(oldData);
            oldData.unshift(newData)
            table_data.reload({
                // page:{curr:1},
                url: '',
                data: oldData
            })

        })

        //新增一行 蓝色套路  杀号
        form.on('submit(formData4)', function (res) {
            console.log(res);
            var field = res.field;
            //重叠码
            var selected_number = []; //关于计算后的尾号所有的号码陈列
            var sq_number = parseInt(field.sq_number);//上1期
            var sq_number1 = parseInt(field.sq_number1);//上2期
            var sq_number2 = parseInt(field.sq_number2);//上3期
            var sq_number3 = parseInt(field.sq_number3);//上4期
            //a+b 绝杀法： 一位直接杀，两位取尾号杀，和为0杀10
            var hz = sq_number + sq_number1;
            console.log(hz);
            if (hz < 10) {
                selected_number.push({ "杀上期+上2期(99%)": hz });
            } else if (hz % 10 == 0) {
                selected_number.push({ "杀上期+上2期(99%)": 10 });
            } else if (hz > 10) {
                selected_number.push({ "杀上期+上2期(99%)": hz % 10 });
            }
            //a+16 绝杀法： 一位直接杀，两位取尾号杀，和为0杀10
            var hz01 = sq_number + 16;
            if (hz01 < 10) {
                selected_number.push({ "杀上期+16(95%)": hz01 });
            } else if (hz01 % 10 == 0) {
                selected_number.push({ "杀上期+16(95%)": 10 });
            } else if (hz01 > 10) {
                selected_number.push({ "杀上期+16(95%)": hz01 % 10 });
            }
            //a+b+c 绝杀法： 一位直接杀，两位取尾号杀，和为0杀10
            var hz02 = sq_number + sq_number1 + sq_number2;
            if (hz02 < 10) {
                selected_number.push({ "杀上期+上2期+上3期(100%)": hz02 });
            } else if (hz02 % 10 == 0) {
                selected_number.push({ "杀上期+上2期+上3期(100%)": 10 });
            } else if (hz02 > 10) {
                selected_number.push({ "杀上期+上2期+上3期(100%)": hz02 % 10 });
            }
            //a+b+c+d 绝杀法： 一位直接杀，两位取尾号杀，和为0杀10
            var hz03 = sq_number + sq_number1 + sq_number2;
            if (hz03 < 10) {
                selected_number.push({ "杀上期+上2期+上3期+上4期(98%)": hz03 });
            } else if (hz03 % 10 == 0) {
                selected_number.push({ "杀上期+上2期+上3期+上4期(98%)": 10 });
            } else if (hz03 > 10) {
                selected_number.push({ "杀上期+上2期+上3期+上4期(98%)": hz03 % 10 });
            }
            //上期6红+蓝值的和值 绝杀法： 一位直接杀，两位取尾号杀，和为0杀10
            var kjhm = field.kjhm.replace(/，/g, ',').substring(0, field.kjhm.lastIndexOf("+"));
            var kjhms = kjhm.split(",");
            var hz04 = 0;
            for (var index = 0; index < kjhms.length; index++) {
                var element = kjhms[index];
                hz04 += parseInt(element)
            }
            hz04+=sq_number;//和值
            if (hz04 < 10) {
                selected_number.push({ "杀上期6红+蓝值的和值(96%)": hz04 });
            } else if (hz04 % 10 == 0) {
                selected_number.push({ "杀上期6红+蓝值的和值(96%)": 10 });
            } else if (hz04 > 10) {
                selected_number.push({ "杀上期6红+蓝值的和值(96%)": hz04 % 10 });
            }
             //s+g 绝杀法： 一位直接杀，两位取尾号杀，和为0杀10
             var hz03 = sq_number + sq_number1 + sq_number2;
            if (hz03 < 10) {
                selected_number.push({ "杀上期+上2期+上3期+上4期(98%)": hz03 });
            } else if (hz03 % 10 == 0) {
                selected_number.push({ "杀上期+上2期+上3期+上4期(98%)": 10 });
            } else if (hz03 > 10) {
                selected_number.push({ "杀上期+上2期+上3期+上4期(98%)": hz03 % 10 });
            }
            console.log(selected_number);
            // selected_number = unique(selected_number)//去重
            // mp(selected_number)//排序
            // console.log(selected_number+"");
            // var newData = { red: selected_number+"", blue: field.lan_number, lx: $('#lx option:selected').text() }
            // var oldData = table.cache['tableDate'];//从缓存中拿数据
            // // console.log(oldData);
            // oldData.unshift(newData)
            // table_data.reload({
            //     // page:{curr:1},
            //     url: '',
            //     data: oldData
            // })

        })

    })




    //叠连码  选1个：人工看自己看图    我这边是随机
    function dlm(cd_number1, cd_number2, cd_number3, all_result_fx) {
        var dl_number = [];
        var xb = 0;
        if (cd_number1 == 1) {
            dl_number[xb] = 2
        } else if (cd_number1 == 33) {
            dl_number[xb] = 32
        } else {
            dl_number[xb] = cd_number1 - 1;
            xb += 1;
            dl_number[xb] = cd_number1 + 1;
        }
        xb += 1;
        if (cd_number2 == 1) {
            dl_number[xb] = 2
        } else if (cd_number2 == 33) {
            dl_number[xb] = 32
        } else {
            dl_number[xb] = cd_number2 - 1;
            xb += 1;
            dl_number[xb] = cd_number2 + 1;
        }
        xb += 1;
        if (cd_number3 == 1) {
            dl_number[xb] = 2
        } else if (cd_number3 == 33) {
            dl_number[xb] = 32
        } else {
            dl_number[xb] = cd_number3 - 1;
            xb += 1;
            dl_number[xb] = cd_number3 + 1;
        }
        dl_number.sort();
        dl_number = unique(dl_number);
        var cd_xb = createRand(0, dl_number.length)//重叠书随机下标
        // console.log(dl_number);
        // console.log(dl_number[cd_xb]);
        all_result_fx.push("{叠连码:" + dl_number + "}");
        return dl_number[cd_xb];
    }
    //同位码  一般是间隔0,1,2,3步 如果重叠码为33 最好间隔1步  则为31  这时候同位码为01,11或21 选两个
    function twm_way(cd_numbers, selected_number, all_result_fx) {
        var tw_random = cd_numbers[createRand(0, cd_numbers.length)];//三个重叠码随机选一个
        var tw_selected;
        //计算同位码
        if (tw_random == 1) {
            tw_selected = 2
        } else if (tw_random == 33) {
            tw_selected = 32
        } else {
            tw_selected = tw_random - 1;
            // Math.floor(tw_selected/10);
            // tw_selected = tw_random + 1;
        }
        var twm = [tw_selected, tw_selected % 10, tw_selected % 10 + 10, tw_selected % 10 + 20] //同位码结果
        if (tw_selected % 10 <= 3) {
            twm.push(tw_selected % 10 + 30)
        }
        twm = unique(twm);
        var sj = twm[createRand(0, twm.length)];
        selected_number.push(sj);
        twm.remove_arr(sj);//删掉选出来的，下面再随机一个
        selected_number.push(twm[createRand(0, twm.length)]);
        all_result_fx.push("{同位码:" + twm + "}");
    }
    //叠码选择
    function dm_xz(selected_number, all_result_fx) {
        var szm_arr = [11, 22, 33]
        var szm_arr1 = []
        for (var index = 0; index < szm_arr.length; index++) {
            var element = szm_arr[index];
            if (selected_number.indexOf(element) > -1) {//是否存在叠码
                szm_arr1.push(element)
            }
        }
        szm_arr.remove_arr(szm_arr1[0]);//删除本身
        if (szm_arr1.length == 1) {//只有一个时候才可以选择另一个
            selected_number.push(szm_arr[createRand(0, szm_arr.length)]);//两个随机一个
        }
        if (szm_arr1.length > 0) {//大于0才有联系 才有选择意义
            all_result_fx.push("{叠码:" + szm_arr + "}");
        }
    }
    //筋斗码 : 12-21  13-31等
    function jdm_xz(selected_number, all_result_fx) {
        var jdm_arr = [1, 10, 2, 20, 3, 30, 12, 21, 13, 31, 23, 32]
        var jdm_selected = [];
        var map = new Map();
        map.set(1, 10); map.set(10, 1);
        map.set(2, 20); map.set(20, 2);
        map.set(3, 30); map.set(30, 3);
        map.set(12, 21); map.set(21, 12);
        map.set(13, 31); map.set(31, 13);
        map.set(23, 32); map.set(32, 23);
        for (var index = 0; index < jdm_arr.length; index++) {
            var element = jdm_arr[index];
            if (selected_number.indexOf(element) > -1) {
                jdm_selected.push(map.get(element))
            }
        }
        // for (var index = 0; index < jdm_selected.length; index++) {
        //     var element = jdm_selected[index];
        //     selected_number.push(parseInt(element))
        // }
        // selected_number.push.apply(selected_number, jdm_selected);
        selected_number.push(...jdm_selected);
        all_result_fx.push("{筋斗码:" + jdm_selected + "}");
    }
    //组合 http://www.360doc.com/content/18/1218/21/6610157_802737278.shtml
    function zh_xz(selected_number, all_result_fx) {
        /**
             * 天地线：1-5-11-15-18-22-28-32
             * 水火线：3-7-9-13-20-24-26-30
             * 木雷线：2-6-10-14-19-23-27-31
             * 山泽线：4-8-12-16-17-21-25-29
             * 
             * 1-33太极：首先分出奇偶就是两仪
             * 再把两仪分化为四象
             * 一象：1-5-9-11-13-17-21-25
             * 二象：2-6-10-14-18-22-26-30
             * 三象：3-7-11-15-19-23-27-31
             * 四象：4-8-12-16-20-24-32
             * 黄金号码：6-7-12-13-16-17-20-21-24-32 
             * 黄金号码组合：
             * 9码常出：4-5-13-14-20-21-27-28-29
             * 万能11码：1-5-9-10-14-15-20-25-29-30-32
             * 
             */
        var tdx = [1, 5, 11, 15, 18, 22, 28, 32]
        var shx = [3, 7, 9, 13, 20, 24, 26, 30];
        var mlx = [2, 6, 10, 14, 19, 23, 27, 31];
        var szx = [4, 8, 12, 16, 17, 21, 25, 29];
        var tdx_pp = [];
        var shx_pp = [];
        var mlx_pp = [];
        var szx_pp = [];
        for (var index = 0; index < selected_number.length; index++) {
            var element = selected_number[index];
            if (tdx.indexOf(element) > -1) {//是否有匹配的
                tdx_pp.push(element)
            }
        }
        for (var index = 0; index < selected_number.length; index++) {
            var element = selected_number[index];
            if (shx.indexOf(element) > -1) {//是否有匹配的
                shx_pp.push(element)
            }
        }
        for (var index = 0; index < selected_number.length; index++) {
            var element = selected_number[index];
            if (mlx.indexOf(element) > -1) {//是否有匹配的
                mlx_pp.push(element)
            }
        }
        for (var index = 0; index < selected_number.length; index++) {
            var element = selected_number[index];
            if (szx.indexOf(element) > -1) {//是否有匹配的
                szx_pp.push(element)
            }
        }
        var map = new Map();
        var map1 = new Map();
        map.set(tdx_pp.length, tdx_pp)
        map.set(shx_pp.length, shx_pp)
        map.set(mlx_pp.length, mlx_pp)
        map.set(szx_pp.length, szx_pp)
        map1.set(tdx_pp.length, tdx)
        map1.set(shx_pp.length, shx)
        map1.set(mlx_pp.length, mlx)
        map1.set(szx_pp.length, szx)
        var pc = [tdx_pp, shx_pp.length, mlx_pp.length, szx_pp.length]
        mp(pc);
        var selected_arr = map.get(pc[3]);//最大的那个是最多的
        if (pc[3] < 3 && selected_arr != undefined && selected_arr.length > 0) {
            var new_arr = del_arr(map1.get(pc[3]), selected_arr);
            if (new_arr.length > 0) {
                if (new_arr.length > 1) {
                    var sj01 = new_arr[createRand(0, new_arr.length)];
                    selected_number.push(sj01);//生成一个随机
                    new_arr.remove_arr(sj01);
                    console.log(new_arr);
                    var sj02 = new_arr[createRand(0, new_arr.length)];
                    selected_number.push(sj02);//生成一个随机
                } else {
                    var sj01 = new_arr[createRand(0, new_arr.length)];
                    selected_number.push(sj01);//生成一个随机
                }
                all_result_fx.push("{组合码:" + new_arr + "}");
            }
        }
    }
    //数组去重
    function unique(arr) {
        return Array.from(new Set(arr))
    }
    //生成随机数的范围
    function createRand(min, max) {
        return Math.floor(min + Math.random() * (max - min));
    }
    //删除数组指定元素

    Array.prototype.indexOf = function (val) {
        for (var i = 0; i < this.length; i++) {
            if (this[i] == val) return i;
        }
        return -1;
    };
    Array.prototype.remove_arr = function (val) {
        var index = this.indexOf(val);
        if (index > -1) {
            this.splice(index, 1);
        }
    };
    //冒泡排序
    function mp(cl_data) {
        for (var i = 0; i < cl_data.length - 1; i++) {
            for (var j = 0; j < cl_data.length - i - 1; j++) {
                if (parseInt(cl_data[j]) > parseInt(cl_data[j + 1])) {
                    var temp = cl_data[j];
                    cl_data[j] = cl_data[j + 1]
                    cl_data[j + 1] = temp;
                }

            }
        }
    }
    // 从一个数组中删除另一个数组中存在的元素
    function del_arr(arr, to_remove) {
        console.log(arr);
        for (let i = arr.length - 1; i >= 0; i--) {
            for (let j = 0; j < to_remove.length; j++) {
                if (arr[i] == to_remove[j]) {
                    arr.splice(i, 1);
                }
            }
        }
        return arr
    }





</script>

</html>